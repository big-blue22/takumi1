<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify Goal Deletion</title>
    <link rel="stylesheet" href="../styles.css">
    <!-- SweetAlert2 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { background-color: #1a1a2e; color: white; padding: 20px; }
        .goal-item { background: #16213e; padding: 15px; margin: 10px 0; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>Goal Deletion Verification</h1>
    <div id="goals-list"></div>

    <!-- Mock minimal App structure before loading app.js dependencies if needed -->
    <script>
        // Mock dependencies that might be missing if not loading full index.html
        // We need to make sure app.js doesn't crash
    </script>

    <!-- Load app.js from root -->
    <script src="../app.js"></script>
    <script>
        // Mock localStorage
        const mockGoals = [
            { id: 12345, title: 'Test Goal', deadline: '2024-12-31', description: 'Test Description', progress: 50 }
        ];
        localStorage.setItem('goals', JSON.stringify(mockGoals));

        // Initialize App manually for testing
        document.addEventListener('DOMContentLoaded', () => {
            if (window.app) {
                // Override loadGoalsList to use our simple container
                app.loadGoalsList = function() {
                    const container = document.getElementById('goals-list');
                    const goals = JSON.parse(localStorage.getItem('goals') || '[]');

                    if (goals.length === 0) {
                        container.innerHTML = '<p>No goals</p>';
                        return;
                    }

                    container.innerHTML = goals.map(goal => `
                        <div class="goal-item" id="goal-${goal.id}">
                            <h3>${goal.title}</h3>
                            <button class="btn-danger" id="delete-btn-${goal.id}" onclick="app.deleteGoal(${goal.id})">削除</button>
                        </div>
                    `).join('');
                };

                app.loadGoalsList();
            } else {
                console.error("App not initialized");
                document.body.innerHTML += "<p style='color:red'>App not initialized</p>";
            }
        });
    </script>
</body>
</html>
